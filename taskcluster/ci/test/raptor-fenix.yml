# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.
---
job-defaults:
    max-run-time: 1800
    suite: raptor
    run-on-projects: []
    test-manifest-loader: null  # don't load tests in the taskgraph
    tier: 1
    target:
        by-test-platform:
            android-hw.*-aarch64.*/.*:
                index: mobile.v2.fenix.nightly.latest.arm64-v8a
                name: build/arm64-v8a/target.apk
            default:
                index: mobile.v2.fenix.nightly.latest.armeabi-v7a
                name: build/armeabi-v7a/target.apk
    e10s: true
    virtualization: hardware
    mozharness:
        script: raptor_script.py
        config:
            - raptor/android_hw_config.py
        extra-options:
            - --app=fenix
            - --binary-path=org.mozilla.fenix
            - --activity=org.mozilla.fenix.IntentReceiverActivity

raptor-youtube-playback-fenix:
    description: "Raptor YouTube Playback on Fenix"
    try-name: raptor-youtube-playback-fenix
    treeherder-symbol: Rap-fenix(ytp)
    run-on-projects: []
    max-run-time: 3600
    test-url-param:
        by-test-platform:
            android-hw-g5.*:
                "exclude=1,2,
                3,4,5,6,7,8,9,10,19,20,21,22,25,26,29,30,33,34,35,36,37,38,39,40,49,50,51,52,
                53,54,55,56,65,66,67,68,69,70,71,72,81,82,83,84,87,88,89,90,93,94,95,96,
                17,18,28,32,47,48,63,64,79,80"
            android-hw-p2.*:  # remove high resolution tests
                "exclude=1,2,
                17,18,28,32,47,48,63,64,79,80"
            default: ""
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback
            # Bug 1558456 - Stop tracking youtube-playback-test on motoG5 for >1080p cases
            # - --test-url-params is dynamically added from setup_raptor transform depending
            # on platform and project

raptor-youtube-playback-h264-sfr-fenix:
    description: "Raptor YouTube Playback H264 SFR on Fenix"
    try-name: raptor-youtube-playback-h264-sfr-fenix
    treeherder-symbol: Rap-fenix(ytp-h264-sfr)
    tier: 2
    max-run-time: 3600
    test-url-param: "exclude=1,2,
                    23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38"
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback-h264-sfr

raptor-youtube-playback-h264-fenix:
    description: "Raptor YouTube Playback H264 on Fenix"
    try-name: raptor-youtube-playback-h264-fenix
    treeherder-symbol: Rap-fenix(ytp-h264)
    tier: 2
    max-run-time: 3600
    test-url-param:
        by-test-platform:
            android-hw-g5.*:  # remove VP9(1-34)and AV1(51-74) tests
                "exclude=1,2,
                3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74"
            android-hw-p2.*:  # remove AV1(51-74) tests
                "exclude=1,2,
                51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74"
            default: ""
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback-h264-std

raptor-youtube-playback-vp9-sfr-fenix:
    description: "Raptor YouTube Playback VP9 SFR on Fenix"
    try-name: raptor-youtube-playback-vp9-sfr-fenix
    treeherder-symbol: Rap-fenix(ytp-vp9-sfr)
    tier: 2
    limit-platforms:
        - android-hw-p2.*
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback-vp9-sfr

raptor-youtube-playback-widevine-hfr-fenix:
    description: "Raptor YouTube Playback Widevine HFR on Fenix"
    try-name: raptor-youtube-playback-widevine-hfr-fenix
    treeherder-symbol: Rap-fenix(ytp-widevine-hfr)
    max-run-time: 3000
    tier: 2
    test-url-param:
        by-test-platform:
            android-hw-g5.*:  # remove VP9(1-34) and AV1 (None) tests
                "exclude=1,2,
                3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34"
            default: ""
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback-widevine-hfr

raptor-youtube-playback-widevine-h264-sfr-fenix:
    description: "Raptor YouTube Playback Widevine H264 SFR on Fenix"
    try-name: raptor-youtube-playback-widevine-h264-sfr
    treeherder-symbol: Rap-fenix(ytp-widevine-h264-sfr)
    max-run-time: 3600
    tier: 2
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback-widevine-h264-sfr

raptor-youtube-playback-widevine-vp9-sfr-fenix:
    description: "Raptor YouTube Playback Widevine VP9 SFR on Fenix"
    try-name: raptor-youtube-playback-widevine-vp9-sfr
    treeherder-symbol: Rap-fenix(ytp-widevine-vp9-sfr)
    max-run-time: 3600
    tier: 2
    limit-platforms:
        - android-hw-p2.*
    mozharness:
        extra-options:
            - --test=raptor-youtube-playback-widevine-vp9-sfr

raptor-speedometer-fenix:
    description: "Raptor Speedometer on Fenix"
    try-name: raptor-speedometer-fenix
    treeherder-symbol: Rap-fenix(sp)
    max-run-time: 2000
    mozharness:
        extra-options:
            - --test=raptor-speedometer
